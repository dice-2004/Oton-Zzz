<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Daily Sleep | Newspaper</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts: Playfair Display (Headlines), Merriweather (Body) -->
    <link
        href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&family=Playfair+Display:wght@400;700;900&display=swap"
        rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

    <style>
        :root {
            --paper-bg: #f4f1ea;
            --ink-color: #2c2c2c;
            --accent-red: #8b0000;
            --border-style: 1px solid #2c2c2c;
            --border-thick: 3px double #2c2c2c;
        }

        body {
            background-color: #e9e5d9;
            /* Desk color */
            color: var(--ink-color);
            font-family: 'Merriweather', serif;
            min-height: 100vh;
            padding: 20px 0;
        }

        /* Paper Container */
        .newspaper {
            background-color: var(--paper-bg);
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E");
        }

        /* Masthead */
        .masthead {
            text-align: center;
            border-bottom: var(--border-thick);
            margin-bottom: 30px;
            padding-bottom: 20px;
        }

        .newspaper-title {
            font-family: 'Playfair Display', serif;
            font-size: 5rem;
            font-weight: 900;
            line-height: 1;
            text-transform: uppercase;
            letter-spacing: -2px;
            margin-bottom: 10px;
        }

        .meta-info {
            border-top: 1px solid #2c2c2c;
            border-bottom: 1px solid #2c2c2c;
            padding: 5px 0;
            display: flex;
            justify-content: space-between;
            text-transform: uppercase;
            font-size: 0.8rem;
            font-weight: 700;
            letter-spacing: 1px;
        }

        /* Headlines */
        h1,
        h2,
        h3,
        h4,
        h5 {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
        }

        .headline-lg {
            font-size: 2.5rem;
            line-height: 1.1;
            margin-bottom: 15px;
            text-align: center;
        }

        .headline-md {
            font-size: 1.8rem;
            margin-bottom: 10px;
            border-bottom: 2px solid #2c2c2c;
            padding-bottom: 5px;
        }

        /* Stats Section */
        .stat-box {
            text-align: center;
            padding: 15px;
            border-right: 1px solid #ccc;
        }

        .stat-box:last-child {
            border-right: none;
        }

        .stat-value {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1;
            margin: 10px 0;
        }

        .stat-label {
            font-family: 'Merriweather', serif;
            font-size: 0.9rem;
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 1px;
            color: #555;
        }

        /* Drop Cap */
        .drop-cap::first-letter {
            float: left;
            font-family: 'Playfair Display', serif;
            font-size: 4rem;
            line-height: 0.8;
            padding-right: 10px;
            padding-top: 5px;
            font-weight: 700;
        }

        /* Table */
        .table {
            --bs-table-bg: transparent;
            font-size: 0.9rem;
            border-top: 2px solid #2c2c2c;
            border-bottom: 2px solid #2c2c2c;
        }

        .table thead th {
            font-family: 'Playfair Display', serif;
            text-transform: uppercase;
            border-bottom: 1px solid #2c2c2c;
            padding: 10px;
        }

        .table td {
            border-bottom: 1px solid #ddd;
            padding: 8px;
        }

        /* Badges (Old style) */
        .badge-news {
            border: 1px solid #2c2c2c;
            background: transparent;
            color: #2c2c2c;
            border-radius: 0;
            font-family: 'Merriweather', serif;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.7rem;
            padding: 2px 6px;
        }

        .badge-sleep {
            background-color: #2c2c2c;
            color: #f4f1ea;
        }

        /* Chart Section */
        .chart-wrapper {
            border: 1px solid #ccc;
            padding: 15px;
            background: #fff;
            /* Photo effect */
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
        }

        .caption {
            font-size: 0.8rem;
            font-style: italic;
            margin-top: 5px;
            color: #555;
            text-align: center;
        }

        /* Columns */
        .col-separator {
            border-right: 1px solid #ccc;
            padding-right: 20px;
        }
    </style>
</head>

<body>

    <div class="newspaper">
        <!-- Masthead -->
        <header class="masthead">
            <div class="newspaper-title">The Daily Sleep</div>
            <div class="meta-info">
                <span>Vol. 1, No. 1</span>
                <span>Tokyo, Japan - {{ logs[0].timestamp.split('T')[0] if logs else '2025-11-27' }}</span>
                <span>Price: Free</span>
            </div>
        </header>

        <!-- Lead Story (Stats) -->
        <section class="mb-5 border-bottom border-dark pb-4">
            <h1 class="headline-lg">SLEEP DETECTED {{ stats.sleep_count }} TIMES THIS WEEK</h1>
            <div class="row mt-4">
                <div class="col-md-8 drop-cap">
                    <p>
                        In a stunning revelation from the Oton-Zzz monitoring system, it has been reported that the user
                        has fallen asleep <strong>{{ stats.sleep_count }} times</strong> during the current observation
                        period.
                        This unprecedented level of drowsiness has led to significant energy savings, thanks to the
                        automated shutdown protocols.
                        Experts suggest that without this intervention, the television would have remained active for an
                        additional <strong>{{ stats.wasted_seconds }} seconds</strong>.
                    </p>
                </div>
                <div class="col-md-4">
                    <div class="stat-box border-0 p-0">
                        <div class="stat-label">Estimated Savings</div>
                        <div class="stat-value">¥{{ stats.estimated_saved_money }}</div>
                        <p class="small text-muted fst-italic">Figure 1: Financial impact of the system.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Secondary Stories -->
        <div class="row">
            <!-- Left Column: Logs -->
            <div class="col-lg-8 col-separator">
                <h2 class="headline-md">Recent Activities</h2>
                <p class="small text-muted mb-3">A chronological account of system events.</p>

                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Event</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for log in logs %}
                        <tr>
                            <td style="white-space: nowrap;">{{ log.timestamp.split('T')[1].split('.')[0] }}</td>
                            <td>
                                {% if log.event_type == 'SLEEP_DETECTED' %}
                                <span class="badge-news badge-sleep">SLEEP</span>
                                {% elif log.event_type == 'TV_ON' %}
                                <span class="badge-news">TV ON</span>
                                {% elif log.event_type == 'TV_OFF' %}
                                <span class="badge-news">TV OFF</span>
                                {% else %}
                                <span class="badge-news">{{ log.event_type }}</span>
                                {% endif %}
                            </td>
                            <td>
                                {{ log.note }}
                                {% if log.duration > 0 %}
                                <span class="fw-bold">({{ log.duration }}s)</span>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Right Column: Chart & Weather -->
            <div class="col-lg-4 ps-4">
                <h2 class="headline-md">Economic Impact</h2>
                <div class="chart-wrapper mb-4">
                    <canvas id="savingsChart" height="250"></canvas>
                    <div class="caption">
                        Fig. 2: Distribution of saved vs. wasted costs.
                    </div>
                </div>

                <div class="p-3" style="background-color: #e9e5d9; border: 1px solid #2c2c2c;">
                    <h4 class="text-center border-bottom border-dark pb-2 mb-2">QUICK STATS</h4>
                    <div class="row text-center">
                        <div class="col-6 mb-3">
                            <div class="small fw-bold">IDLE TIME</div>
                            <div class="fs-4 fw-bold">{{ stats.wasted_seconds }}</div>
                        </div>
                        <div class="col-6 mb-3">
                            <div class="small fw-bold">COST</div>
                            <div class="fs-4 fw-bold">¥{{ stats.wasted_money }}</div>
                        </div>
                    </div>
                </div>

                <div class="mt-4 text-center">
                    <p class="small fst-italic">
                        "Sleep is the golden chain that ties health and our bodies together."<br>
                        - Thomas Dekker
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Chart.js Configuration
        Chart.defaults.font.family = "'Merriweather', serif";
        Chart.defaults.color = '#2c2c2c';

        const ctx = document.getElementById('savingsChart').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['Saved', 'Wasted'],
                datasets: [{
                    data: [{{ stats.estimated_saved_money }}, {{ stats.wasted_money }}],
            backgroundColor: [
                '#2c2c2c',  // Black (Ink)
                '#8b0000'   // Dark Red
            ],
            borderColor: '#f4f1ea',
            borderWidth: 2
        }]
        },
            options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        usePointStyle: true,
                        pointStyle: 'rect',
                        font: {
                            family: "'Playfair Display', serif"
                        }
                    }
                }
            }
        }
    });
    </script>

</body>

</html>
